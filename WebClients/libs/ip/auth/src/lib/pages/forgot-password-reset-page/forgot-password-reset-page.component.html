<ip-page-header subTitle="Restore password"></ip-page-header>
<form class="center-form" nz-form [formGroup]="form" (ngSubmit)="submitForm()">
    <nz-form-item>
        <nz-form-label [nzSm]="6" [nzXs]="24" nzFor="password" nzRequired
            >Password</nz-form-label
        >
        <nz-form-control
            [nzSm]="14"
            [nzXs]="24"
            [nzErrorTip]="passwordErrorTpl"
        >
            <input
                data-cy="password"
                nz-input
                type="password"
                id="password"
                formControlName="password"
                (ngModelChange)="updateConfirmValidator()"
            />
            <ng-template #passwordErrorTpl let-control>
                <span
                    data-cy="password-required-error"
                    *ngIf="control.hasError('empty')"
                >
                    Password should not be empty
                </span>
                <span
                    data-cy="password-min-length-error"
                    *ngIf="control.hasError('minlength')"
                >
                    Password should not be less than 6 characters
                </span>
                <span
                    data-cy="password-max-length-error"
                    *ngIf="control.hasError('maxlength')"
                >
                    Password should not be more than 100 characters
                </span>
                <span
                    data-cy="password-miss-upper-case-letter-error"
                    *ngIf="control.hasError('miss-upper-case-letter')"
                >
                    Password should contain at least one upper case letter
                </span>
                <span
                    data-cy="password-miss-lower-case-letter-error"
                    *ngIf="control.hasError('miss-lower-case-letter')"
                >
                    Password should contain at least one lower case letter
                </span>
                <span
                    data-cy="password-miss-digit-error"
                    *ngIf="control.hasError('miss-digit')"
                >
                    Password should contain at least one digit
                </span>
                <span
                    data-cy="password-miss-special-char-error"
                    *ngIf="control.hasError('miss-special-char')"
                >
                    Password should contain at least one special character
                    [@#$%^&*()_+=\[&U+007B;\]&U+007D;;:&#60;&#62;|./?,-!]
                </span>
            </ng-template>
        </nz-form-control>
    </nz-form-item>
    <nz-form-item>
        <nz-form-label [nzSm]="6" [nzXs]="24" nzFor="checkPassword" nzRequired
            >Confirm Password</nz-form-label
        >
        <nz-form-control
            [nzSm]="14"
            [nzXs]="24"
            [nzErrorTip]="confirmPasswordErrorTpl"
        >
            <input
                data-cy="confirm-password"
                nz-input
                type="password"
                formControlName="checkPassword"
                id="checkPassword"
            />
            <ng-template #confirmPasswordErrorTpl let-control>
                <span
                    data-cy="confirm-password-required"
                    *ngIf="control.hasError('required')"
                >
                    Please confirm your password!
                </span>
                <span
                    data-cy="confirm-password-not-match-error"
                    *ngIf="control.hasError('confirm')"
                >
                    Two passwords that you enter is inconsistent!
                </span>
            </ng-template>
        </nz-form-control>
    </nz-form-item>

    <nz-alert
        data-cy="submit-error"
        nz-row
        *ngIf="errorMessage"
        nzType="error"
        nzCloseable
        nzMessage="Error"
        [nzDescription]="errorMessage"
        style="margin-bottom: 25px;"
    >
    </nz-alert>

    <nz-form-item nz-row class="register-area">
        <nz-form-control [nzSpan]="14" [nzOffset]="6">
            <button
                data-cy="submit"
                [nzLoading]="isSubmitting"
                [disabled]="form.invalid"
                nz-button
                nzType="primary"
            >
                Reset Password
            </button>
        </nz-form-control>
    </nz-form-item>
</form>
